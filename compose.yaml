version: '3.8'

services:
  processor:
    container_name: ${PROJECT_NAME}-processor
    build: .
    env_file:
        - .env
    ports:
      - "9010:9010"
    environment:
      - PYTHONPATH=/srv/app
    volumes:
      - ./api:/srv/app
    restart: unless-stopped
    networks:
      - substream-network

  processor-worker:
    container_name: ${PROJECT_NAME}-processor-worker
    build: .
    env_file:
        - .env
    ports:
      - "9011:9010"
    environment:
      - PYTHONPATH=/srv/app
    volumes:
      - ./api:/srv/app
    restart: unless-stopped
    command: celery -A task.celery worker --loglevel=info --queues=get_video_task
    networks:
      - substream-network

networks:
  substream-network:
    external: true